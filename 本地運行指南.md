# 本地運行指南

本指南適用於 **macOS** 和 **Windows** 系統。

## 第一步：安裝 Node.js

您的系統目前沒有安裝 Node.js。請按照以下步驟安裝：

### macOS 安裝方法

#### 方法 1：使用 Homebrew（推薦）

1. **安裝 Homebrew**（如果尚未安裝）：
   ```bash
   /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
   ```

2. **使用 Homebrew 安裝 Node.js**：
   ```bash
   brew install node
   ```

#### 方法 2：從官網下載安裝

1. 前往 [Node.js 官網](https://nodejs.org/)
2. 下載 LTS（長期支援）版本
3. 執行安裝程式並按照指示完成安裝

#### 方法 3：使用 nvm（Node Version Manager）

1. **安裝 nvm**：
   ```bash
   curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
   ```

2. **重新載入終端或執行**：
   ```bash
   source ~/.zshrc
   ```

3. **安裝 Node.js**：
   ```bash
   nvm install --lts
   nvm use --lts
   ```

### Windows 安裝方法

#### 方法 1：從官網下載安裝（推薦，最簡單）

1. **前往 Node.js 官網**：
   - 打開瀏覽器，訪問 [https://nodejs.org/](https://nodejs.org/)
   - 點擊下載 **LTS（長期支援）版本**（推薦，例如 v20.x.x）

2. **執行安裝程式**：
   - 下載完成後，雙擊 `.msi` 安裝檔
   - 按照安裝精靈的指示完成安裝
   - **重要**：安裝時請勾選「Add to PATH」選項（通常預設已勾選）

3. **完成安裝**：
   - 安裝完成後，**重新啟動命令提示字元（CMD）或 PowerShell**

#### 方法 2：使用 Chocolatey（適合進階用戶）

1. **安裝 Chocolatey**（如果尚未安裝）：
   - 以**系統管理員身份**打開 PowerShell
   - 執行以下命令：
   ```powershell
   Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
   ```

2. **使用 Chocolatey 安裝 Node.js**：
   ```powershell
   choco install nodejs-lts -y
   ```

#### 方法 3：使用 nvm-windows（適合需要多版本管理的用戶）

1. **下載 nvm-windows**：
   - 前往 [https://github.com/coreybutler/nvm-windows/releases](https://github.com/coreybutler/nvm-windows/releases)
   - 下載 `nvm-setup.exe` 並執行安裝

2. **安裝 Node.js**：
   - 以**系統管理員身份**打開命令提示字元（CMD）或 PowerShell
   - 執行：
   ```cmd
   nvm install lts
   nvm use lts
   ```

### 驗證安裝

安裝完成後，在終端執行以下命令驗證：

```bash
node --version
npm --version
```

應該會顯示版本號（例如：v20.x.x 和 10.x.x）

---

## 第二步：安裝專案依賴

在專案目錄下執行：

**macOS / Linux：**
```bash
cd /path/to/tsa-repair-system
npm install
```

**Windows（命令提示字元 CMD）：**
```cmd
cd C:\path\to\tsa-repair-system
npm install
```

**Windows（PowerShell）：**
```powershell
cd C:\path\to\tsa-repair-system
npm install
```

> **注意**：請將路徑替換為您的實際專案路徑

這會安裝所有必要的套件（React、Vite、TypeScript 等），可能需要幾分鐘時間。

---

## 第三步：設置環境變數（可選）

如果您需要使用 Gemini AI 功能，需要設置 API Key：

1. **創建 `.env.local` 文件**：

   **macOS / Linux：**
   ```bash
   touch .env.local
   ```

   **Windows：**
   - 在專案資料夾中，右鍵點擊空白處
   - 選擇「新增」→「文字文件」
   - 將檔案命名為 `.env.local`（注意：檔案名稱前面有個點）
   - 如果 Windows 不允許以點開頭，可以先命名為 `env.local`，然後在命令提示字元執行：
     ```cmd
     ren env.local .env.local
     ```

2. **編輯文件並添加**：
   ```env
   GEMINI_API_KEY=your_api_key_here
   ```
   
   > 注意：如果沒有 API Key，系統仍可運行，但 AI 分析功能將無法使用。

---

## 第四步：啟動開發伺服器

執行以下命令：

```bash
npm run dev
```

成功啟動後，您會看到類似以下的訊息：

```
  VITE v6.x.x  ready in xxx ms

  ➜  Local:   http://localhost:3000/
  ➜  Network: http://192.168.x.x:3000/
```

在瀏覽器中打開 `http://localhost:3000` 即可使用系統。

---

## 常用命令

- **啟動開發伺服器**：`npm run dev`
- **構建生產版本**：`npm run build`
- **預覽生產版本**：`npm run preview`
- **停止伺服器**：在終端按 `Ctrl + C`

---

## 疑難排解

### 問題：`npm: command not found`

**解決**：Node.js 未正確安裝或未加入 PATH。請重新安裝 Node.js 並重新開啟終端。

### 問題：端口 3000 已被占用

**解決**：修改 `vite.config.ts` 中的 `server.port` 為其他端口（如 3001、8080 等）

### 問題：依賴安裝失敗

**解決（macOS / Linux）：**
```bash
# 清除快取並重新安裝
rm -rf node_modules package-lock.json
npm cache clean --force
npm install
```

**解決（Windows）：**
```cmd
# 在命令提示字元（CMD）執行
rmdir /s /q node_modules
del package-lock.json
npm cache clean --force
npm install
```

```powershell
# 或在 PowerShell 執行
Remove-Item -Recurse -Force node_modules
Remove-Item -Force package-lock.json
npm cache clean --force
npm install
```

### 問題：頁面顯示空白

**解決**：
1. 檢查瀏覽器控制台是否有錯誤
2. 確認所有依賴已正確安裝
3. 嘗試清除瀏覽器快取

---

## 快速啟動腳本

### macOS / Linux

執行 `start.sh` 腳本：
```bash
./start.sh
```

### Windows

執行 `start.bat` 腳本：
```cmd
start.bat
```

或在 PowerShell 中：
```powershell
.\start.bat
```

這些腳本會自動檢查 Node.js、安裝依賴並啟動開發伺服器。

---

## 系統差異說明

### 路徑格式
- **macOS / Linux**：使用正斜線 `/`，例如 `/Users/username/project`
- **Windows**：使用反斜線 `\`，例如 `C:\Users\username\project`

### 終端工具
- **macOS**：Terminal（終端機）或 iTerm2
- **Windows**：命令提示字元（CMD）或 PowerShell（推薦）

### 檔案權限
- **macOS / Linux**：可能需要使用 `chmod +x` 賦予腳本執行權限
- **Windows**：通常不需要特殊權限，但某些操作可能需要以系統管理員身份執行

---

## 下一步

系統運行後，您可以：
- 測試各種功能模組
- 修改程式碼並查看即時更新（熱重載）
- 開發新功能

祝您使用愉快！🎉

