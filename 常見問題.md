# 常見問題 FAQ

本文件收集開發與使用過程中常見的問題與解決方案。

## 📋 目錄

- [環境設置問題](#環境設置問題)
- [開發問題](#開發問題)
- [功能問題](#功能問題)
- [部署問題](#部署問題)

---

## 環境設置問題

### Q1: 如何安裝 Node.js？

**macOS：**
- 方法 1：`brew install node`
- 方法 2：從 [nodejs.org](https://nodejs.org/) 下載安裝

**Windows：**
- 方法 1：從 [nodejs.org](https://nodejs.org/) 下載安裝（推薦）
- 方法 2：使用 Chocolatey：`choco install nodejs-lts -y`

詳細說明請參考 [本地運行指南.md](./本地運行指南.md)

---

### Q2: `npm: command not found` 錯誤

**原因：** Node.js 未正確安裝或未加入 PATH

**解決方案：**
1. 確認 Node.js 已安裝：`node --version`
2. 如果未安裝，請重新安裝 Node.js
3. **Windows**：重新啟動命令提示字元或 PowerShell
4. **macOS/Linux**：重新啟動終端或執行 `source ~/.zshrc`

---

### Q3: 依賴安裝失敗

**解決方案：**

**macOS/Linux：**
```bash
rm -rf node_modules package-lock.json
npm cache clean --force
npm install
```

**Windows (CMD)：**
```cmd
rmdir /s /q node_modules
del package-lock.json
npm cache clean --force
npm install
```

**Windows (PowerShell)：**
```powershell
Remove-Item -Recurse -Force node_modules
Remove-Item -Force package-lock.json
npm cache clean --force
npm install
```

如果仍然失敗，請檢查：
- 網路連接是否正常
- 是否使用代理（需要配置 npm 代理）
- Node.js 版本是否為 18+

---

### Q4: 如何創建 `.env.local` 文件？

**macOS/Linux：**
```bash
touch .env.local
```

**Windows：**
- 方法 1：在專案資料夾中，右鍵 → 新增 → 文字文件，命名為 `.env.local`
- 方法 2：如果無法以點開頭命名，先創建 `env.local`，然後在命令提示字元執行：
  ```cmd
  ren env.local .env.local
  ```

然後編輯文件，添加：
```env
GEMINI_API_KEY=your_api_key_here
```

---

## 開發問題

### Q5: 無法連續輸入多個字

**原因：** 狀態更新使用了舊的狀態值

**解決方案：** 使用函數式更新

```typescript
// ✅ 正確
onChange={e => setFormData(prev => ({...prev, field: e.target.value}))}

// ❌ 錯誤
onChange={e => setFormData({...formData, field: e.target.value})}
```

已修復的檔案：
- `components/MobileSimulation.tsx`
- `components/NewRequestForm.tsx`

如果其他組件也有此問題，請使用相同方式修復。

---

### Q6: 端口 3000 已被占用

**解決方案：**

1. **修改端口**（推薦）：
   編輯 `vite.config.ts`：
   ```typescript
   server: {
     port: 3001,  // 改為其他端口
     host: '0.0.0.0',
   }
   ```

2. **關閉占用端口的程序**：
   **macOS/Linux：**
   ```bash
   lsof -ti:3000 | xargs kill -9
   ```
   
   **Windows：**
   ```cmd
   netstat -ano | findstr :3000
   taskkill /PID <PID號碼> /F
   ```

---

### Q7: 頁面顯示空白

**檢查步驟：**

1. **檢查瀏覽器控制台**
   - 按 F12 打開開發者工具
   - 查看 Console 標籤頁是否有錯誤

2. **檢查依賴是否安裝**
   ```bash
   ls node_modules  # macOS/Linux
   dir node_modules  # Windows
   ```

3. **清除瀏覽器快取**
   - Chrome/Edge：Ctrl+Shift+Delete（Windows）或 Cmd+Shift+Delete（macOS）
   - 選擇「快取的圖片和檔案」

4. **重新安裝依賴**
   ```bash
   rm -rf node_modules package-lock.json
   npm install
   ```

5. **檢查構建錯誤**
   ```bash
   npm run build
   ```

---

### Q8: TypeScript 類型錯誤

**解決方案：**

1. **檢查類型定義**
   ```bash
   npx tsc --noEmit
   ```

2. **確認導入路徑正確**
   ```typescript
   import { TypeName } from './types';
   ```

3. **檢查 `tsconfig.json` 配置**
   - 確認 `paths` 配置正確
   - 確認 `types` 包含所需類型

---

### Q9: 熱重載（Hot Reload）不工作

**解決方案：**

1. **確認開發伺服器正在運行**
   ```bash
   npm run dev
   ```

2. **檢查文件是否被監視**
   - 確認文件在專案目錄內
   - 確認文件未被 `.gitignore` 忽略

3. **手動重新載入**
   - 瀏覽器按 F5 或 Ctrl+R

4. **重啟開發伺服器**
   - 按 Ctrl+C 停止
   - 重新執行 `npm run dev`

---

## 功能問題

### Q10: Gemini AI 功能無法使用

**可能原因：**

1. **未設置 API Key**
   - 創建 `.env.local` 文件
   - 添加 `GEMINI_API_KEY=your_api_key_here`

2. **API Key 無效**
   - 確認 API Key 正確
   - 檢查 API Key 是否過期

3. **配額用盡**
   - 檢查 Gemini API 配額
   - 等待配額重置或升級方案

4. **網路問題**
   - 檢查網路連接
   - 確認可以訪問 Google API

**測試 API Key：**
```bash
# 在瀏覽器控制台測試
console.log(import.meta.env.VITE_GEMINI_API_KEY)
```

---

### Q11: 表單提交後沒有反應

**檢查步驟：**

1. **檢查表單驗證**
   - 確認必填欄位已填寫
   - 檢查是否有驗證錯誤訊息

2. **檢查控制台錯誤**
   - 打開開發者工具（F12）
   - 查看 Console 是否有錯誤

3. **檢查提交處理函數**
   - 確認 `onSubmit` 函數正確定義
   - 確認沒有阻止預設行為的問題

4. **檢查網路請求**
   - 查看 Network 標籤頁
   - 確認請求是否發送

---

### Q12: 圖片上傳功能不工作

**檢查步驟：**

1. **檢查文件選擇器**
   - 確認 `input[type="file"]` 元素存在
   - 確認 `accept` 屬性設置正確

2. **檢查文件大小限制**
   - 確認文件未超過限制
   - 檢查是否有錯誤訊息

3. **檢查 FileReader API**
   - 確認瀏覽器支援 FileReader
   - 檢查控制台是否有錯誤

---

## 部署問題

### Q13: 構建失敗

**檢查步驟：**

1. **檢查 Node.js 版本**
   ```bash
   node --version  # 需要 18+
   ```

2. **檢查依賴**
   ```bash
   npm install
   ```

3. **檢查 TypeScript 錯誤**
   ```bash
   npx tsc --noEmit
   ```

4. **檢查環境變數**
   - 確認構建時環境變數已設置
   - 檢查 `vite.config.ts` 配置

---

### Q14: 部署後網站空白

**可能原因：**

1. **Base path 配置錯誤**
   - 檢查 `vite.config.ts` 中的 `base` 路徑
   - 確認與部署路徑一致

2. **404.html 未生成**
   - 確認構建流程包含生成 404.html
   - 檢查 `dist` 目錄是否有 `404.html`

3. **資源路徑錯誤**
   - 檢查瀏覽器 Network 標籤頁
   - 確認資源路徑正確

---

### Q15: 環境變數在生產環境不生效

**解決方案：**

1. **GitHub Pages**
   - 在 GitHub Secrets 中設置 `GEMINI_API_KEY`
   - 構建時會自動注入

2. **Vercel**
   - 在 Vercel Dashboard → Settings → Environment Variables
   - 添加 `GEMINI_API_KEY`

3. **Netlify**
   - 在 Netlify Dashboard → Site settings → Environment variables
   - 添加 `GEMINI_API_KEY`

4. **本地構建測試**
   ```bash
   npm run build
   npm run preview
   ```

---

## 其他問題

### Q16: 如何更新依賴？

```bash
# 檢查過時的套件
npm outdated

# 更新所有依賴（謹慎使用）
npm update

# 更新特定套件
npm install package-name@latest
```

---

### Q17: 如何清除所有快取？

```bash
# 清除 npm 快取
npm cache clean --force

# 清除 node_modules 和鎖定文件
rm -rf node_modules package-lock.json  # macOS/Linux
rmdir /s /q node_modules & del package-lock.json  # Windows

# 重新安裝
npm install
```

---

### Q18: 如何切換 Node.js 版本？

**使用 nvm（推薦）：**

**macOS/Linux：**
```bash
nvm install 20
nvm use 20
```

**Windows（nvm-windows）：**
```cmd
nvm install 20
nvm use 20
```

---

## 需要更多協助？

如果以上問題都無法解決，請：

1. 查看 [本地運行指南.md](./本地運行指南.md)
2. 查看 [開發者協作指南.md](./開發者協作指南.md)
3. 在 GitHub 上創建 Issue，包含：
   - 作業系統版本
   - Node.js 版本
   - 錯誤訊息截圖
   - 重現步驟

---

最後更新：2024

